<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Optimal Transport üï∑Ô∏è and Wasserstein distance | lucia's notes</title>
<meta name=keywords content="optimal transport,wsdistance"><meta name=description content="Intro to Optimal Transport with spider Cedric (Villani) :) üï∑Ô∏è"><meta name=author content="Lucia"><link rel=canonical href=https://ldomenichelli.github.io/posts/post2/><link crossorigin=anonymous href=/assets/css/stylesheet.5ad9b1caa92e4cea83ebcd3088e97362f239b07d8144490aaf0bc1d6bd89cd17.css integrity="sha256-WtmxyqkuTOqD680wiOlzYvI5sH2BREkKrwvB1r2JzRc=" rel="preload stylesheet" as=style><link rel=icon href=https://ldomenichelli.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ldomenichelli.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ldomenichelli.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ldomenichelli.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ldomenichelli.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ldomenichelli.github.io/posts/post2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script><style>@media screen and (min-width:769px){.post-content input[type=checkbox]:checked~label>img{transform:scale(1.6);cursor:zoom-out;position:relative;z-index:999}.post-content img.zoomCheck{transition:transform .15s ease;z-index:999;cursor:zoom-in}}</style><meta property="og:title" content="Optimal Transport üï∑Ô∏è and Wasserstein distance"><meta property="og:description" content="Intro to Optimal Transport with spider Cedric (Villani) :) üï∑Ô∏è"><meta property="og:type" content="article"><meta property="og:url" content="https://ldomenichelli.github.io/posts/post2/"><meta property="og:image" content="https://ldomenichelli.github.io/logo.png"><meta property="article:section" content="posts"><meta property="og:site_name" content="lucia's notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ldomenichelli.github.io/logo.png"><meta name=twitter:title content="Optimal Transport üï∑Ô∏è and Wasserstein distance"><meta name=twitter:description content="Intro to Optimal Transport with spider Cedric (Villani) :) üï∑Ô∏è"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"","item":"https://ldomenichelli.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Optimal Transport üï∑Ô∏è and Wasserstein distance","item":"https://ldomenichelli.github.io/posts/post2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Optimal Transport üï∑Ô∏è and Wasserstein distance","name":"Optimal Transport üï∑Ô∏è and Wasserstein distance","description":"Intro to Optimal Transport with spider Cedric (Villani) :) üï∑Ô∏è","keywords":["optimal transport","wsdistance"],"articleBody":"To qualify as a distance, a measure must satisfy the following properties:\nSymmetry: $ d(P, Q) = d(Q, P) )$ Triangle inequality: $ d(P, Q) + d(Q, R) \\geq d(P, R) $ However, in practice, we often deal with weaker notions of distances, commonly referred to as divergences.\nExample: KL Divergence The Kullback-Leibler (KL) divergence is defined as: $$ D_{\\text{KL}}(P || Q) = \\int p(x) \\log \\frac{p(x)}{q(x)} dx $$\nProperties of KL Divergence Not Symmetric: $$ D_{\\text{KL}}(P || Q) \\neq D_{\\text{KL}}(Q || P) $$ Infinite for Different Supports: $$ D_{\\text{KL}}(P || Q) \\to \\infty \\quad \\text{if } P \\text{ and } Q \\text{ have different supports.} $$\nAddressing These Challenges Solution 1: Smoothing Distributions To avoid the issue of different supports, one solution is to smooth the distributions to match their supports.\nSolution 2: Use a Different Divergence An alternative approach is to use a divergence that naturally handles different supports and adheres to desirable distance properties. One such measure is the Wasserstein Distance.\nWasserstein Distance The Wasserstein distance, rooted in optimal transport theory, addresses the shortcomings of KL divergence by offering:\nSymmetry Triangle inequality A meaningful geometry of the space of distributions. Intuition Behind Optimal Transport The Wasserstein distance can be understood as the minimum ‚Äúcost‚Äù to transform one distribution into another. Imagine redistributing the ‚Äúmass‚Äù of one distribution $P$ to match another distribution $Q$. Each unit of mass has a transportation cost proportional to the distance it is moved.\nFormally, the $p$-Wasserstein distance is defined as:\n$$ W_p(P, Q) = \\left( \\inf_{\\gamma \\in \\Pi(P, Q)} \\int | x - y |^p d\\gamma(x, y) \\right)^{1/p} $$ Here:\n$ \\Pi(P, Q) $: The set of all couplings (joint distributions) with marginals $P$ and $Q$. $ | x - y | $: The cost of moving mass from $x$ to $y$. Properties of Wasserstein Distance Captures the geometric relationship between distributions. Finite even for distributions with disjoint supports. Offers meaningful insights in contexts like generative modeling and comparing empirical distributions. Optimal transport and the Wasserstein distance are widely used in fields such as:\nMachine Learning: Generative models (e.g., GANs with Wasserstein loss). Economics: Resource allocation problems. Physics: Modeling fluid dynamics. Image Processing: Comparing distributions of pixel intensities. By leveraging the principles of optimal transport, we gain a robust and versatile framework for comparing and transforming probability distributions.\nMore in written notes: ","wordCount":"390","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Lucia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ldomenichelli.github.io/posts/post2/"},"publisher":{"@type":"Organization","name":"lucia's notes","logo":{"@type":"ImageObject","url":"https://ldomenichelli.github.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://ldomenichelli.github.io/ accesskey=h title="lucia's notes (Alt + H)">lucia's notes</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><ul class="menu hidden"><li><a href=https://ldomenichelli.github.io/about/ title=about><span>about</span></a></li><li><a href=https://ldomenichelli.github.io/posts/ title=notes><span>notes</span></a></li><li><a href=https://ldomenichelli.github.io/random/ title=hobbies><span>hobbies</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ldomenichelli.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://ldomenichelli.github.io/posts/></a></div><h1 class=post-title>Optimal Transport üï∑Ô∏è and Wasserstein distance</h1><div class=post-description>Intro to Optimal Transport with spider Cedric (Villani) :) üï∑Ô∏è</div><div class=post-meta>Lucia</div></header><div class="toc side left"><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#example-kl-divergence>Example: KL Divergence</a><ul><li><a href=#properties-of-kl-divergence>Properties of KL Divergence</a></li></ul></li></ul></li><li><a href=#addressing-these-challenges>Addressing These Challenges</a><ul><li><a href=#solution-1-smoothing-distributions>Solution 1: Smoothing Distributions</a></li><li><a href=#solution-2-use-a-different-divergence>Solution 2: Use a Different Divergence</a></li></ul></li><li><a href=#wasserstein-distance>Wasserstein Distance</a><ul><li><a href=#intuition-behind-optimal-transport>Intuition Behind Optimal Transport</a></li><li><a href=#properties-of-wasserstein-distance>Properties of Wasserstein Distance</a></li><li><a href=#more-in-written-notes>More in written notes:</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>To qualify as a <strong>distance</strong>, a measure must satisfy the following properties:</p><ol><li><strong>Symmetry</strong>: $ d(P, Q) = d(Q, P) )$</li><li><strong>Triangle inequality</strong>: $ d(P, Q) + d(Q, R) \geq d(P, R) $</li></ol><p>However, in practice, we often deal with <strong>weaker notions of distances</strong>, commonly referred to as <strong>divergences</strong>.</p><h3 id=example-kl-divergence>Example: KL Divergence<a hidden class=anchor aria-hidden=true href=#example-kl-divergence>#</a></h3><p>The Kullback-Leibler (KL) divergence is defined as:
$$
D_{\text{KL}}(P || Q) = \int p(x) \log \frac{p(x)}{q(x)} dx
$$</p><h4 id=properties-of-kl-divergence>Properties of KL Divergence<a hidden class=anchor aria-hidden=true href=#properties-of-kl-divergence>#</a></h4><ol><li><strong>Not Symmetric</strong>:
$$
D_{\text{KL}}(P || Q) \neq D_{\text{KL}}(Q || P)
$$</li><li><strong>Infinite for Different Supports</strong>:</li></ol><p>$$
D_{\text{KL}}(P || Q) \to \infty \quad \text{if } P \text{ and } Q \text{ have different supports.}
$$</p><h2 id=addressing-these-challenges>Addressing These Challenges<a hidden class=anchor aria-hidden=true href=#addressing-these-challenges>#</a></h2><h3 id=solution-1-smoothing-distributions>Solution 1: Smoothing Distributions<a hidden class=anchor aria-hidden=true href=#solution-1-smoothing-distributions>#</a></h3><p>To avoid the issue of different supports, one solution is to <strong>smooth the distributions</strong> to match their supports.</p><h3 id=solution-2-use-a-different-divergence>Solution 2: Use a Different Divergence<a hidden class=anchor aria-hidden=true href=#solution-2-use-a-different-divergence>#</a></h3><p>An alternative approach is to use a divergence that naturally handles different supports and adheres to desirable distance properties. One such measure is the <strong>Wasserstein Distance</strong>.</p><h2 id=wasserstein-distance>Wasserstein Distance<a hidden class=anchor aria-hidden=true href=#wasserstein-distance>#</a></h2><p>The <strong>Wasserstein distance</strong>, rooted in <strong>optimal transport theory</strong>, addresses the shortcomings of KL divergence by offering:</p><ul><li><strong>Symmetry</strong></li><li><strong>Triangle inequality</strong></li><li>A meaningful geometry of the space of distributions.</li></ul><h3 id=intuition-behind-optimal-transport>Intuition Behind Optimal Transport<a hidden class=anchor aria-hidden=true href=#intuition-behind-optimal-transport>#</a></h3><p>The Wasserstein distance can be understood as the minimum &ldquo;cost&rdquo; to <strong>transform one distribution into another</strong>. Imagine redistributing the &ldquo;mass&rdquo; of one distribution $P$ to match another distribution $Q$. Each unit of mass has a transportation cost proportional to the distance it is moved.</p><p>Formally, the $p$-Wasserstein distance is defined as:</p><p>$$
W_p(P, Q) = \left( \inf_{\gamma \in \Pi(P, Q)} \int | x - y |^p d\gamma(x, y) \right)^{1/p}
$$
Here:</p><ul><li>$ \Pi(P, Q) $: The set of all couplings (joint distributions) with marginals $P$ and $Q$.</li><li>$ | x - y | $: The cost of moving mass from $x$ to $y$.</li></ul><h3 id=properties-of-wasserstein-distance>Properties of Wasserstein Distance<a hidden class=anchor aria-hidden=true href=#properties-of-wasserstein-distance>#</a></h3><ol><li>Captures the <strong>geometric relationship</strong> between distributions.</li><li>Finite even for distributions with <strong>disjoint supports</strong>.</li><li>Offers meaningful insights in contexts like generative modeling and comparing empirical distributions.</li></ol><p>Optimal transport and the Wasserstein distance are widely used in fields such as:</p><ul><li><strong>Machine Learning</strong>: Generative models (e.g., GANs with Wasserstein loss).</li><li><strong>Economics</strong>: Resource allocation problems.</li><li><strong>Physics</strong>: Modeling fluid dynamics.</li><li><strong>Image Processing</strong>: Comparing distributions of pixel intensities.</li></ul><p>By leveraging the principles of optimal transport, we gain a robust and versatile framework for comparing and transforming probability distributions.</p><h3 id=more-in-written-notes>More in written notes:<a hidden class=anchor aria-hidden=true href=#more-in-written-notes>#</a></h3><embed src=/ot.pdf width=100% height=600px type=application/pdf></div><footer class=post-footer><ul class=post-tags><li><a href=https://ldomenichelli.github.io/tags/optimal-transport/>Optimal Transport</a></li><li><a href=https://ldomenichelli.github.io/tags/wsdistance/>Wsdistance</a></li></ul><nav class=paginav><a class=prev href=https://ldomenichelli.github.io/posts/post6/><span class=title>¬´ Prev</span><br><span>Notes on Mechanistic Interpretability</span>
</a><a class=next href=https://ldomenichelli.github.io/posts/post3/><span class=title>Next ¬ª</span><br><span>Simplicity Bias</span></a></nav></footer></article></main><footer class=footer style=padding-top:18px;padding-bottom:18px><div class=social-icons style=padding-bottom:0><a style=border-bottom:none href=https://x.com/workerplacemint rel=me title=Twitter><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</a><a style=border-bottom:none href=https://github.com/ldomenichelli rel=me title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a style=border-bottom:none href=mailto:ldomenichelli2@gmail.com rel=me title=Email><svg viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></div><span>&copy; 2025 <a href=https://ldomenichelli.github.io/>lucia's notes</a></span>
<span>‚Ä¢
Powered by
<a href=https://gohugo.io/>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/>PaperMod</a>
</span><span>‚Ä¢
<a href=/privacy>Privacy Policy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let b=document.querySelector("#menu-trigger"),m=document.querySelector(".menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(e){b.contains(e.target)||m.classList.add("hidden")})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>